import java.io.*;
import java.util.*;
public class CopyOfAgenda {
    static List<CopyOfAuxiliar> agenda;
    static Scanner scanner;
    public static void main(String[] args) throws IOException {
        scanner = new Scanner(System.in);
        agenda = new ArrayList();
        int opcao = -1;
        File arquivo = new File("agendaTelefonica.csv");
        if (arquivo.exists()){
            lerArquivo();
        }
        while (opcao != 0){
            System.out.println("Menu Principal");
            System.out.println(" 1.Adicionar Contato");
            System.out.println(" 2.Excluir Contato");
            System.out.println(" 3.Listar Contatos");
            System.out.println(" 4.Editar Contato");
            System.out.println(" 5.Procurar Contato");
            System.out.println(" 0.Encerrar");
            opcao = scanner.nextInt(); 
            if (opcao > 0) comando(opcao);
        } 
    }

    public static void lerArquivo() throws IOException{
        BufferedReader bufferedReader = new BufferedReader(new FileReader("agendaTelefonica.csv"));
        String linha = bufferedReader.readLine();
        int posVirgula;
        while (linha != null){
            posVirgula = linha.indexOf(";");         
            agenda.add(new CopyOfAuxiliar(linha.substring(0, posVirgula),linha.substring(posVirgula + 1)));
            linha = bufferedReader.readLine();            
        }
        bufferedReader.close();
    }
    
    public static void gravarArquivo() throws IOException{
        FileWriter fileWriter = new FileWriter(new File("agendaTelefonica.csv"));
        for (int i = 0; i < agenda.size(); i++){
            CopyOfAuxiliar contato = agenda.get(i);      
            if (i > 0) fileWriter.write("\n");
            fileWriter.write(contato.nome + ";" + contato.telefone);
        }
        fileWriter.close();
    }
    
    public static void comando(int opcao){
        if (agenda.isEmpty() && (opcao == 1 || opcao == 3 || opcao == 4 || opcao == 5)){
            System.out.println("A agenda esta vazia.");
            return;
        }
        if (opcao == 1){
            AdicionarContato();
        }else if (opcao == 2){
            ExcluirContato();
        }else if (opcao == 3){
            ListarContatos();
        }else if (opcao == 4){
            EditarContato();
        }else if (opcao == 5){    
            ProcurarContato();
        }
    }

    public static void AdicionarContato() {
        scanner.nextLine();
        CopyOfAuxiliar contato = new CopyOfAuxiliar();
        System.out.println("Digite o nome do contato:");
        String lido = scanner.nextLine();
        if (lido != null) {
            contato.nome = lido;
        }

        System.out.println("Digite o telefone do contato:");
        lido = scanner.nextLine();
        if (lido != null) {
            contato.telefone = lido;
        }

        agenda.add(contato);
    }

    public static void ExcluirContato() {
        scanner.nextLine();
        System.out.println("Digite o nome do contato:");
        String nomePesquisado = scanner.nextLine();
        if (nomePesquisado.equals("")) {
            System.out.println("Nome inválido");
        } else {
            int indice = retornaIndice(nomePesquisado);
            if (indice == -1) {
                System.out.println("Contato não encontrado.");
            } else {
                try {
                    agenda.remove(indice);
                    System.out.println("Contato removido.");
                } catch (Exception var3) {
                    System.out.println("Falha na remoção do contato. Motivo: " + var3);
                }
            }
        }
    }

    public static void ProcurarContato() {
        scanner.nextLine();
        System.out.println("Digite o nome do contato:");
        String nomePesquisado = scanner.nextLine();
        if (nomePesquisado.equals("")) {
            System.out.println("Nome inválido");
        } else {
            int indice = retornaIndice(nomePesquisado);
            if (indice == -1) {
                System.out.println("Contato não encontrado.");
            } else {
                System.out.println("O telefone deste contato é: " + ((CopyOfAuxiliar)agenda.get(indice)).telefone);
            }
        }
    }

    public static void EditarContato() {
        scanner.nextLine();
        System.out.println("Digite o nome do contato:");
        String nomePesquisado = scanner.nextLine();
        if (nomePesquisado.equals("")) {
            System.out.println("Nome inválido");
        } else {
            int indice = retornaIndice(nomePesquisado);
            if (indice == -1) {
                System.out.println("Contato não encontrado.");
            } else {
                System.out.println("Selecione o que deseja alterar:");
                System.out.println("1- Nome");
                System.out.println("2- Telefone");
                int opcao = scanner.nextInt();
                scanner.nextLine();
                if (opcao == 1) {
                    System.out.println("Digite o novo nome: ");
                    ((CopyOfAuxiliar)agenda.get(indice)).nome = scanner.nextLine();
                } else if (opcao == 2) {
                    System.out.println("Digite o novo telefone: ");
                    ((CopyOfAuxiliar)agenda.get(indice)).telefone = scanner.nextLine();
                } else {
                    System.out.println("Opção inválida.");
                }
            }
        }

    }

    public static void ListarContatos() {
        for(int i = 0; i < agenda.size(); ++i) {
            CopyOfAuxiliar contato = agenda.get(i);
            System.out.println("Nome: " + contato.nome + " - Telefone: " + contato.telefone);
        }
    }

    public static int retornaIndice(String nome) {
        for(int i = 0; i < agenda.size(); ++i) {
            if (((CopyOfAuxiliar)agenda.get(i)).nome.toUpperCase().equals(nome.toUpperCase())) {
                return i;
            }
        }
        return -1;
    }

    public static void ordenarLista() {
       CopyOfAuxiliar.sort
    }
}
